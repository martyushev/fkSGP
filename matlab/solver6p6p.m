% forward kinematics of fully planar 6P-6P Stewart-Gough platform
%
% input:
%  X - 6x3 matrix with coordinates of attachment points on the base
%  platform, first row and last column of X are assumed to be zero
%  x - 6x3 matrix with coordinates of attachment points on the top
%  platform, first row and last column of x are assumed to be zero
%  L - 6-vector of squared leg lengths
%  realOnly - real postures only flag (0/1)
%
% output:
%  Rt  - cell k-array of 3x4 matrices with estimated rigid-body transformations
%  err - k-vector of errors
function [Rt,err] = solver6p6p(X,x,L,realOnly)

    [C,U,RR] = coefs6p6p(X,x,L);
    S = red_171x210_6p6p(C,L(1));
    [Rt,err] = S2Rt6p6p(S,C,U,RR,realOnly);

end



function [C,U,RR] = coefs6p6p(X,x,L)

    RR = {cayley([0;0;randn]), cayley([0;0;randn])}; % random rotations to prevent dummy singularities
    X = X*RR{1};
    x = x*RR{2};

    C = zeros(12,44);

    C([120,143,175,188,201,214]) = -1;
    C([2:6,14:18,38:42,50:54,74:78,86:90,98:102,127,156,164,301:306,361:366,374:378,383,393,398:402,406,505:510]) = 1;
    C(517) = -L(1);
    x2_6 = x(2:6); x8_12 = x(8:12);
    X2_6 = X(2:6); X8_12 = X(8:12);
    xv = [x2_6,x8_12]; Xv = [X2_6,X8_12];
    C([350:354,434:438]) = -4*xv;
    C([218:222,230:234,326:330,266:270,458:462,290:294]) = repmat(4*xv,1,3);
    C(422:426) = -4*x2_6.*X8_12-4*x8_12.*X2_6;
    C(470:474) = 4*x2_6.*X8_12-4*x8_12.*X2_6;
    C([26:30,62:66,278:282,314:318]) = repmat(-2*xv-2*Xv,1,2);
    C([254:258,338:342,482:486,494:498]) = repmat(2*xv-2*Xv,1,2);
    base = x2_6.^2+x8_12.^2+X2_6.^2+X8_12.^2-L(2:6)';
    C(242:246) = base+2*x2_6.*X2_6+2*x8_12.*X8_12;
    C(410:414) = base-2*x2_6.*X2_6+2*x8_12.*X8_12;
    C(446:450) = base+2*x2_6.*X2_6-2*x8_12.*X8_12;
    C(518:522) = base-2*x2_6.*X2_6-2*x8_12.*X8_12;

    C = C./vecnorm(C,2,2);

    U = @(s)[s(6)^2*s(7)^2;s(6)^2*s(8)^2;s(6)^2*s(7);s(1)*s(7)^2;s(4)*s(7)^2;s(6)^2*s(8);s(1)*s(8)^2;s(4)*s(8)^2;s(6)^2*s(9);s(2)^2;s(3)*s(2);s(3)^2;s(4)*s(1);s(4)*s(3);s(5)*s(1);s(5)*s(2);s(5)*s(3);s(5)^2;s(6)*s(3);s(6)*s(5);s(6)^2;s(7)*s(1);s(7)*s(2);s(7)*s(4);s(7)*s(6);s(7)^2;s(8)*s(1);s(8)*s(2);s(8)*s(4);s(8)*s(6);s(8)^2;s(1)*s(9);s(2)*s(9);s(4)*s(9);s(1);s(2);s(3);s(4);s(5);s(6);s(7);s(8);s(9);1];

end



% Input: coefficient matrix C of size 12x44
% Output: solution matrix S of size 9x39

function S = red_171x210_6p6p(C,L1)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,107,107,107,107,107,107,107,107,107,107,107,107,107,107,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,109,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,111,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,114,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,115,116,116,116,116,116,116,116,116,116,116,116,116,116,116,116,116,116,116,116,116,117,117,117,117,117,117,117,117,117,117,117,117,117,117,117,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,119,119,119,119,119,119,119,119,119,119,119,119,119,119,119,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,123,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,125,125,125,125,125,125,125,125,125,125,125,125,125,125,125,125,125,125,125,125,125,125,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,126,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,138,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,139,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,141,141,141,141,141,141,141,141,141,141,141,141,141,141,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,142,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,143,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,144,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,145,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,146,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,147,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,148,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,149,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,152,152,152,152,152,152,152,152,152,152,152,152,152,152,152,152,152,152,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,154,155,155,155,155,155,155,155,155,155,155,155,155,155,155,155,155,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,159,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,161,161,161,161,161,161,161,161,161,161,161,161,161,161,161,161,161,161,161,161,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,162,163,163,163,163,163,163,163,163,163,163,163,163,163,163,163,163,163,163,163,163,163,163,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,165,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,166,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,167,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,169,169,169,169,169,169,169,169,169,169,169,169,169,169,169,169,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171,171],[107,157,160,178,292,317,318,319,320,321,324,326,334,337,338,340,341,342,343,344,345,346,347,348,349,356,372,378,381,383,384,385,386,388,79,133,135,171,275,276,310,311,338,339,340,348,378,387,69,122,125,167,206,276,304,320,321,322,323,324,325,326,333,334,335,336,337,347,352,356,369,371,372,373,374,386,55,107,108,111,157,158,160,162,163,178,205,275,292,304,317,318,319,322,323,331,332,336,346,352,367,368,373,385,43,102,105,162,204,242,257,272,277,278,279,289,290,291,292,302,303,353,355,370,372,374,375,377,379,380,381,382,383,384,385,386,387,388,42,99,101,152,153,161,176,177,203,241,256,271,278,286,287,288,299,300,301,328,329,330,332,335,345,368,371,383,41,95,98,151,160,175,202,240,255,283,284,285,291,296,297,298,307,309,314,315,316,319,326,330,334,340,344,359,363,366,370,382,40,93,97,150,152,155,156,159,165,166,170,173,174,175,176,201,239,254,270,277,282,295,327,331,333,343,367,369,381,39,91,96,149,154,158,164,172,173,200,238,253,281,284,290,294,297,303,306,308,313,315,318,321,325,329,339,342,358,362,365,380,38,90,95,157,199,237,252,280,281,283,289,293,294,296,302,305,307,312,313,314,317,320,324,327,328,338,341,357,360,361,364,379,25,77,78,136,210,214,270,271,272,273,274,275,276,310,311,375,376,377,378,387,24,74,76,131,135,170,209,213,269,307,308,309,340,359,377,23,73,75,130,132,134,137,168,169,208,212,268,274,306,308,339,358,376,22,72,74,133,207,211,266,267,273,305,306,307,338,357,375,21,69,70,71,122,123,125,127,128,167,205,262,263,304,322,323,336,352,373,20,67,68,127,198,204,214,254,256,257,261,302,303,350,351,352,353,354,355,356,369,370,371,372,373,374,386,19,65,66,126,197,203,249,251,256,263,265,299,300,301,335,371,18,61,64,125,166,196,202,213,246,250,255,259,296,297,298,301,323,326,334,351,355,370,17,60,63,124,165,166,195,201,245,249,254,258,260,262,264,295,333,369,16,59,62,121,123,129,164,165,194,200,212,244,248,253,261,294,297,300,303,304,321,325,354,15,58,61,122,193,199,211,243,247,252,259,293,294,295,296,299,302,320,322,324,350,353,14,55,56,57,69,79,104,106,107,108,109,111,113,114,122,123,125,127,133,135,157,158,159,160,161,162,163,167,171,178,13,43,53,54,102,103,105,107,113,162,198,210,239,241,242,261,273,289,290,291,292,350,351,352,367,368,373,385,12,42,51,52,99,100,101,106,112,161,197,234,236,241,263,286,287,288,332,368,11,41,47,50,95,96,98,105,111,156,160,196,209,231,235,240,259,283,284,285,288,291,319,323,351,10,40,46,49,93,94,97,104,110,155,156,159,195,230,234,239,258,260,262,282,331,367,9,39,45,48,91,92,96,103,109,121,154,155,158,194,208,229,233,238,261,281,284,287,290,304,318,8,38,44,47,90,91,95,102,108,157,193,207,228,232,237,259,280,281,282,283,286,289,317,322,350,7,38,41,107,185,192,199,202,225,226,227,237,238,240,242,252,253,255,257,277,278,279,292,356,357,359,364,365,366,372,378,384,6,36,37,106,152,153,184,191,223,224,226,232,233,235,241,247,248,250,256,265,267,269,278,311,361,362,363,368,371,383,5,34,35,104,131,149,150,151,152,183,190,219,223,225,228,229,231,239,243,244,246,254,264,266,277,310,360,367,369,381,4,31,33,82,100,118,145,146,182,189,217,222,233,248,287,300,329,362,3,30,32,99,148,181,188,215,216,221,232,247,286,299,328,361,2,27,29,81,83,86,87,97,116,117,141,142,143,144,147,151,156,166,170,175,180,187,220,231,246,1,26,28,80,82,84,85,87,94,115,116,138,139,140,142,146,149,155,165,169,173,179,186,218,229,244,107,157,160,178,292,317,318,319,320,321,324,326,334,337,338,340,341,342,343,344,345,346,347,348,349,356,372,378,381,383,384,385,386,388,79,133,135,171,275,276,310,311,338,339,340,348,378,387,69,122,125,167,206,276,304,320,321,322,323,324,325,326,333,334,335,336,337,347,352,356,369,371,372,373,374,386,55,107,108,111,157,158,160,162,163,178,205,275,292,304,317,318,319,322,323,331,332,336,346,352,367,368,373,385,43,102,105,162,204,242,257,272,277,278,279,289,290,291,292,302,303,353,355,370,372,374,375,377,379,380,381,382,383,384,385,386,387,388,42,99,101,152,153,161,176,177,203,241,256,271,278,286,287,288,299,300,301,328,329,330,332,335,345,368,371,383,41,95,98,151,160,175,202,240,255,283,284,285,291,296,297,298,307,309,314,315,316,319,326,330,334,340,344,359,363,366,370,382,40,93,97,150,152,155,156,159,165,166,170,173,174,175,176,201,239,254,270,277,282,295,327,331,333,343,367,369,381,39,91,96,149,154,158,164,172,173,200,238,253,281,284,290,294,297,303,306,308,313,315,318,321,325,329,339,342,358,362,365,380,38,90,95,157,199,237,252,280,281,283,289,293,294,296,302,305,307,312,313,314,317,320,324,327,328,338,341,357,360,361,364,379,25,77,78,136,210,214,270,271,272,273,274,275,276,310,311,375,376,377,378,387,24,74,76,131,135,170,209,213,269,307,308,309,340,359,377,23,73,75,130,132,134,137,168,169,208,212,268,274,306,308,339,358,376,22,72,74,133,207,211,266,267,273,305,306,307,338,357,375,21,69,70,71,122,123,125,127,128,167,205,262,263,304,322,323,336,352,373,20,67,68,127,198,204,214,254,256,257,261,302,303,350,351,352,353,354,355,356,369,370,371,372,373,374,386,19,65,66,126,197,203,249,251,256,263,265,299,300,301,335,371,18,61,64,125,166,196,202,213,246,250,255,259,296,297,298,301,323,326,334,351,355,370,17,60,63,124,165,166,195,201,245,249,254,258,260,262,264,295,333,369,16,59,62,121,123,129,164,165,194,200,212,244,248,253,261,294,297,300,303,304,321,325,354,15,58,61,122,193,199,211,243,247,252,259,293,294,295,296,299,302,320,322,324,350,353,14,55,56,57,69,79,104,106,107,108,109,111,113,114,122,123,125,127,133,135,157,158,159,160,161,162,163,167,171,178,13,43,53,54,102,103,105,107,113,162,198,210,239,241,242,261,273,289,290,291,292,350,351,352,367,368,373,385,12,42,51,52,99,100,101,106,112,161,197,234,236,241,263,286,287,288,332,368,11,41,47,50,95,96,98,105,111,156,160,196,209,231,235,240,259,283,284,285,288,291,319,323,351,10,40,46,49,93,94,97,104,110,155,156,159,195,230,234,239,258,260,262,282,331,367,9,39,45,48,91,92,96,103,109,121,154,155,158,194,208,229,233,238,261,281,284,287,290,304,318,8,38,44,47,90,91,95,102,108,157,193,207,228,232,237,259,280,281,282,283,286,289,317,322,350,7,38,41,107,185,192,199,202,225,226,227,237,238,240,242,252,253,255,257,277,278,279,292,356,357,359,364,365,366,372,378,384,6,36,37,106,152,153,184,191,223,224,226,232,233,235,241,247,248,250,256,265,267,269,278,311,361,362,363,368,371,383,5,34,35,104,131,149,150,151,152,183,190,219,223,225,228,229,231,239,243,244,246,254,264,266,277,310,360,367,369,381,4,31,33,82,100,118,145,146,182,189,217,222,233,248,287,300,329,362,3,30,32,99,148,181,188,215,216,221,232,247,286,299,328,361,2,27,29,81,83,86,87,97,116,117,141,142,143,144,147,151,156,166,170,175,180,187,220,231,246,1,26,28,80,82,84,85,87,94,115,116,138,139,140,142,146,149,155,165,169,173,179,186,218,229,244,107,157,160,178,292,317,318,319,320,321,324,326,334,337,338,340,341,342,343,344,345,346,347,348,349,356,372,378,381,383,384,385,386,388,79,133,135,171,275,276,310,311,338,339,340,348,378,387,69,122,125,167,206,276,304,320,321,322,323,324,325,326,333,334,335,336,337,347,352,356,369,371,372,373,374,386,55,107,108,111,157,158,160,162,163,178,205,275,292,304,317,318,319,322,323,331,332,336,346,352,367,368,373,385,43,102,105,162,204,242,257,272,277,278,279,289,290,291,292,302,303,353,355,370,372,374,375,377,379,380,381,382,383,384,385,386,387,388,42,99,101,152,153,161,176,177,203,241,256,271,278,286,287,288,299,300,301,328,329,330,332,335,345,368,371,383,41,95,98,151,160,175,202,240,255,283,284,285,291,296,297,298,307,309,314,315,316,319,326,330,334,340,344,359,363,366,370,382,40,93,97,150,152,155,156,159,165,166,170,173,174,175,176,201,239,254,270,277,282,295,327,331,333,343,367,369,381,39,91,96,149,154,158,164,172,173,200,238,253,281,284,290,294,297,303,306,308,313,315,318,321,325,329,339,342,358,362,365,380,38,90,95,157,199,237,252,280,281,283,289,293,294,296,302,305,307,312,313,314,317,320,324,327,328,338,341,357,360,361,364,379,25,77,78,136,210,214,270,271,272,273,274,275,276,310,311,375,376,377,378,387,24,74,76,131,135,170,209,213,269,307,308,309,340,359,377,23,73,75,130,132,134,137,168,169,208,212,268,274,306,308,339,358,376,22,72,74,133,207,211,266,267,273,305,306,307,338,357,375,21,69,70,71,122,123,125,127,128,167,205,262,263,304,322,323,336,352,373,20,67,68,127,198,204,214,254,256,257,261,302,303,350,351,352,353,354,355,356,369,370,371,372,373,374,386,19,65,66,126,197,203,249,251,256,263,265,299,300,301,335,371,18,61,64,125,166,196,202,213,246,250,255,259,296,297,298,301,323,326,334,351,355,370,17,60,63,124,165,166,195,201,245,249,254,258,260,262,264,295,333,369,16,59,62,121,123,129,164,165,194,200,212,244,248,253,261,294,297,300,303,304,321,325,354,15,58,61,122,193,199,211,243,247,252,259,293,294,295,296,299,302,320,322,324,350,353,14,55,56,57,69,79,104,106,107,108,109,111,113,114,122,123,125,127,133,135,157,158,159,160,161,162,163,167,171,178,13,43,53,54,102,103,105,107,113,162,198,210,239,241,242,261,273,289,290,291,292,350,351,352,367,368,373,385,12,42,51,52,99,100,101,106,112,161,197,234,236,241,263,286,287,288,332,368,11,41,47,50,95,96,98,105,111,156,160,196,209,231,235,240,259,283,284,285,288,291,319,323,351,10,40,46,49,93,94,97,104,110,155,156,159,195,230,234,239,258,260,262,282,331,367,9,39,45,48,91,92,96,103,109,121,154,155,158,194,208,229,233,238,261,281,284,287,290,304,318,8,38,44,47,90,91,95,102,108,157,193,207,228,232,237,259,280,281,282,283,286,289,317,322,350,7,38,41,107,185,192,199,202,225,226,227,237,238,240,242,252,253,255,257,277,278,279,292,356,357,359,364,365,366,372,378,384,6,36,37,106,152,153,184,191,223,224,226,232,233,235,241,247,248,250,256,265,267,269,278,311,361,362,363,368,371,383,5,34,35,104,131,149,150,151,152,183,190,219,223,225,228,229,231,239,243,244,246,254,264,266,277,310,360,367,369,381,4,31,33,82,100,118,145,146,182,189,217,222,233,248,287,300,329,362,3,30,32,99,148,181,188,215,216,221,232,247,286,299,328,361,2,27,29,81,83,86,87,97,116,117,141,142,143,144,147,151,156,166,170,175,180,187,220,231,246,1,26,28,80,82,84,85,87,94,115,116,138,139,140,142,146,149,155,165,169,173,179,186,218,229,244,107,157,160,178,292,317,318,319,320,321,324,326,334,337,338,340,341,342,343,344,345,346,347,348,349,356,372,378,381,383,384,385,386,388,79,133,135,171,275,276,310,311,338,339,340,348,378,387,69,122,125,167,206,276,304,320,321,322,323,324,325,326,333,334,335,336,337,347,352,356,369,371,372,373,374,386,55,107,108,111,157,158,160,162,163,178,205,275,292,304,317,318,319,322,323,331,332,336,346,352,367,368,373,385,43,102,105,162,204,242,257,272,277,278,279,289,290,291,292,302,303,353,355,370,372,374,375,377,379,380,381,382,383,384,385,386,387,388,42,99,101,152,153,161,176,177,203,241,256,271,278,286,287,288,299,300,301,328,329,330,332,335,345,368,371,383,41,95,98,151,160,175,202,240,255,283,284,285,291,296,297,298,307,309,314,315,316,319,326,330,334,340,344,359,363,366,370,382,40,93,97,150,152,155,156,159,165,166,170,173,174,175,176,201,239,254,270,277,282,295,327,331,333,343,367,369,381,39,91,96,149,154,158,164,172,173,200,238,253,281,284,290,294,297,303,306,308,313,315,318,321,325,329,339,342,358,362,365,380,38,90,95,157,199,237,252,280,281,283,289,293,294,296,302,305,307,312,313,314,317,320,324,327,328,338,341,357,360,361,364,379,25,77,78,136,210,214,270,271,272,273,274,275,276,310,311,375,376,377,378,387,24,74,76,131,135,170,209,213,269,307,308,309,340,359,377,23,73,75,130,132,134,137,168,169,208,212,268,274,306,308,339,358,376,22,72,74,133,207,211,266,267,273,305,306,307,338,357,375,21,69,70,71,122,123,125,127,128,167,205,262,263,304,322,323,336,352,373,19,65,66,126,197,203,249,251,256,263,265,299,300,301,335,371,18,61,64,125,166,196,202,213,246,250,255,259,296,297,298,301,323,326,334,351,355,370,17,60,63,124,165,166,195,201,245,249,254,258,260,262,264,295,333,369,16,59,62,121,123,129,164,165,194,200,212,244,248,253,261,294,297,300,303,304,321,325,354,15,58,61,122,193,199,211,243,247,252,259,293,294,295,296,299,302,320,322,324,350,353,14,55,56,57,69,79,104,106,107,108,109,111,113,114,122,123,125,127,133,135,157,158,159,160,161,162,163,167,171,178,13,43,53,54,102,103,105,107,113,162,198,210,239,241,242,261,273,289,290,291,292,350,351,352,367,368,373,385,12,42,51,52,99,100,101,106,112,161,197,234,236,241,263,286,287,288,332,368,11,41,47,50,95,96,98,105,111,156,160,196,209,231,235,240,259,283,284,285,288,291,319,323,351,10,40,46,49,93,94,97,104,110,155,156,159,195,230,234,239,258,260,262,282,331,367,9,39,45,48,91,92,96,103,109,121,154,155,158,194,208,229,233,238,261,281,284,287,290,304,318,8,38,44,47,90,91,95,102,108,157,193,207,228,232,237,259,280,281,282,283,286,289,317,322,350,7,38,41,107,185,192,199,202,225,226,227,237,238,240,242,252,253,255,257,277,278,279,292,356,357,359,364,365,366,372,378,384,6,36,37,106,152,153,184,191,223,224,226,232,233,235,241,247,248,250,256,265,267,269,278,311,361,362,363,368,371,383,5,34,35,104,131,149,150,151,152,183,190,219,223,225,228,229,231,239,243,244,246,254,264,266,277,310,360,367,369,381,4,31,33,82,100,118,145,146,182,189,217,222,233,248,287,300,329,362,3,30,32,99,148,181,188,215,216,221,232,247,286,299,328,361,2,27,29,81,83,86,87,97,116,117,141,142,143,144,147,151,156,166,170,175,180,187,220,231,246,1,26,28,80,82,84,85,87,94,115,116,138,139,140,142,146,149,155,165,169,173,179,186,218,229,244,107,157,160,178,292,317,318,319,320,321,324,326,334,337,338,340,341,342,343,344,345,346,347,348,349,356,372,378,381,383,384,385,386,388,79,133,135,171,275,276,310,311,338,339,340,348,378,387,69,122,125,167,206,276,304,320,321,322,323,324,325,326,333,334,335,336,337,347,352,356,369,371,372,373,374,386,55,107,108,111,157,158,160,162,163,178,205,275,292,304,317,318,319,322,323,331,332,336,346,352,367,368,373,385,43,102,105,162,204,242,257,272,277,278,279,289,290,291,292,302,303,353,355,370,372,374,375,377,379,380,381,382,383,384,385,386,387,388,42,99,101,152,153,161,176,177,203,241,256,271,278,286,287,288,299,300,301,328,329,330,332,335,345,368,371,383,41,95,98,151,160,175,202,240,255,283,284,285,291,296,297,298,307,309,314,315,316,319,326,330,334,340,344,359,363,366,370,382,40,93,97,150,152,155,156,159,165,166,170,173,174,175,176,201,239,254,270,277,282,295,327,331,333,343,367,369,381,39,91,96,149,154,158,164,172,173,200,238,253,281,284,290,294,297,303,306,308,313,315,318,321,325,329,339,342,358,362,365,380,38,90,95,157,199,237,252,280,281,283,289,293,294,296,302,305,307,312,313,314,317,320,324,327,328,338,341,357,360,361,364,379,25,77,78,136,210,214,270,271,272,273,274,275,276,310,311,375,376,377,378,387,24,74,76,131,135,170,209,213,269,307,308,309,340,359,377,23,73,75,130,132,134,137,168,169,208,212,268,274,306,308,339,358,376,22,72,74,133,207,211,266,267,273,305,306,307,338,357,375,21,69,70,71,122,123,125,127,128,167,205,262,263,304,322,323,336,352,373,19,65,66,126,197,203,249,251,256,263,265,299,300,301,335,371,18,61,64,125,166,196,202,213,246,250,255,259,296,297,298,301,323,326,334,351,355,370,17,60,63,124,165,166,195,201,245,249,254,258,260,262,264,295,333,369,16,59,62,121,123,129,164,165,194,200,212,244,248,253,261,294,297,300,303,304,321,325,354,15,58,61,122,193,199,211,243,247,252,259,293,294,295,296,299,302,320,322,324,350,353,14,55,56,57,69,79,104,106,107,108,109,111,113,114,122,123,125,127,133,135,157,158,159,160,161,162,163,167,171,178,12,42,51,52,99,100,101,106,112,161,197,234,236,241,263,286,287,288,332,368,11,41,47,50,95,96,98,105,111,156,160,196,209,231,235,240,259,283,284,285,288,291,319,323,351,10,40,46,49,93,94,97,104,110,155,156,159,195,230,234,239,258,260,262,282,331,367,9,39,45,48,91,92,96,103,109,121,154,155,158,194,208,229,233,238,261,281,284,287,290,304,318,8,38,44,47,90,91,95,102,108,157,193,207,228,232,237,259,280,281,282,283,286,289,317,322,350,7,38,41,107,185,192,199,202,225,226,227,237,238,240,242,252,253,255,257,277,278,279,292,356,357,359,364,365,366,372,378,384,5,34,35,104,131,149,150,151,152,183,190,219,223,225,228,229,231,239,243,244,246,254,264,266,277,310,360,367,369,381,4,31,33,82,100,118,145,146,182,189,217,222,233,248,287,300,329,362,3,30,32,99,148,181,188,215,216,221,232,247,286,299,328,361,2,27,29,81,83,86,87,97,116,117,141,142,143,144,147,151,156,166,170,175,180,187,220,231,246,1,26,28,80,82,84,85,87,94,115,116,138,139,140,142,146,149,155,165,169,173,179,186,218,229,244],C([2,38,50,302,26,254,266,278,314,326,74,86,338,362,374,398,410,422,434,446,458,482,494,506,518,14,62,98,218,230,242,290,350,470,2,38,50,302,26,62,218,230,410,422,446,518,242,470,2,38,50,302,14,98,266,410,422,254,278,314,326,338,434,446,458,482,494,518,26,62,218,230,242,290,350,470,2,26,38,50,254,266,278,290,302,482,14,98,242,326,410,422,446,314,338,434,458,494,518,62,218,230,350,470,2,38,50,302,14,26,62,98,218,230,242,254,266,278,290,314,326,74,86,338,350,362,374,398,410,422,434,446,458,470,482,494,506,518,2,38,50,218,230,302,434,458,14,26,62,98,242,254,266,278,314,326,338,410,422,446,482,494,518,290,350,470,2,38,50,218,302,434,14,26,62,254,266,278,290,314,326,338,374,398,410,422,446,482,362,458,494,506,518,98,230,242,350,470,2,38,50,218,230,266,278,302,326,338,398,422,434,446,458,14,26,62,98,242,254,314,410,482,494,518,290,350,470,2,38,50,218,266,302,326,422,434,14,26,62,254,278,290,314,338,350,374,398,410,446,482,494,362,458,506,518,98,230,242,470,2,38,50,302,14,26,62,254,266,278,290,314,326,338,350,374,398,410,422,446,482,494,362,434,458,506,518,98,218,230,242,470,2,38,50,302,26,62,218,230,242,254,266,290,350,434,458,410,422,446,470,518,2,38,50,218,302,434,26,62,230,410,422,446,518,242,470,2,38,50,218,266,302,326,422,434,26,62,230,290,410,446,518,242,470,2,38,50,302,26,62,218,230,290,410,422,446,518,242,470,2,26,38,50,254,266,278,290,302,482,62,218,230,422,410,446,518,242,470,2,38,50,302,26,62,98,218,230,242,266,410,422,254,278,290,314,326,338,350,434,446,458,470,482,494,518,2,38,50,302,26,62,218,230,242,290,350,410,422,446,518,470,2,38,50,302,434,26,62,98,218,230,242,254,410,422,446,458,482,494,518,290,350,470,2,38,50,302,422,446,26,62,218,230,242,266,278,290,350,410,518,470,2,38,50,266,302,326,422,434,26,62,98,218,230,242,290,410,446,458,470,482,518,494,350,2,38,50,302,26,62,98,218,230,242,278,410,422,434,446,458,470,518,482,494,290,350,2,26,38,50,62,98,218,230,242,254,266,278,290,302,314,326,338,350,374,398,410,422,434,446,458,470,482,494,506,518,2,26,38,50,254,266,278,290,302,482,62,98,218,230,242,326,374,410,422,446,470,314,338,350,434,458,494,518,2,26,38,50,254,266,278,290,302,482,62,218,230,242,350,410,422,446,518,470,2,26,38,50,254,266,278,290,302,434,482,62,98,218,230,242,314,410,422,446,458,470,518,494,350,2,26,38,50,254,266,278,290,302,422,446,482,62,218,230,242,326,338,350,410,518,470,2,26,38,50,254,266,278,290,302,326,422,434,482,62,98,218,230,242,350,410,446,458,470,494,518,2,26,38,50,254,266,278,290,302,482,62,98,218,230,242,338,410,422,434,446,458,470,518,494,350,2,38,50,302,26,62,74,86,218,230,242,254,266,278,290,314,326,338,350,434,458,470,482,362,374,398,410,422,446,494,506,518,2,38,50,302,434,458,26,62,218,230,242,254,266,278,290,314,326,338,350,362,374,398,470,506,410,422,446,482,494,518,2,38,50,302,398,422,434,446,458,26,62,218,230,242,254,266,278,290,314,326,338,350,362,374,470,506,410,482,494,518,2,38,50,218,302,326,422,434,26,62,230,242,290,350,482,494,518,470,2,38,50,302,458,26,62,218,230,242,290,350,482,494,518,470,2,38,50,218,230,254,266,302,326,338,410,422,434,446,458,470,482,494,506,518,26,62,242,290,350,2,38,50,218,230,254,266,278,302,326,338,410,422,434,446,458,470,482,494,506,518,26,62,242,290,350,3,39,51,303,27,255,267,279,315,327,75,87,339,363,375,399,411,423,435,447,459,483,495,507,519,15,63,99,219,231,243,291,351,471,3,39,51,303,27,63,219,231,411,423,447,519,243,471,3,39,51,303,15,99,267,411,423,255,279,315,327,339,435,447,459,483,495,519,27,63,219,231,243,291,351,471,3,27,39,51,255,267,279,291,303,483,15,99,243,327,411,423,447,315,339,435,459,495,519,63,219,231,351,471,3,39,51,303,15,27,63,99,219,231,243,255,267,279,291,315,327,75,87,339,351,363,375,399,411,423,435,447,459,471,483,495,507,519,3,39,51,219,231,303,435,459,15,27,63,99,243,255,267,279,315,327,339,411,423,447,483,495,519,291,351,471,3,39,51,219,303,435,15,27,63,255,267,279,291,315,327,339,375,399,411,423,447,483,363,459,495,507,519,99,231,243,351,471,3,39,51,219,231,267,279,303,327,339,399,423,435,447,459,15,27,63,99,243,255,315,411,483,495,519,291,351,471,3,39,51,219,267,303,327,423,435,15,27,63,255,279,291,315,339,351,375,399,411,447,483,495,363,459,507,519,99,231,243,471,3,39,51,303,15,27,63,255,267,279,291,315,327,339,351,375,399,411,423,447,483,495,363,435,459,507,519,99,219,231,243,471,3,39,51,303,27,63,219,231,243,255,267,291,351,435,459,411,423,447,471,519,3,39,51,219,303,435,27,63,231,411,423,447,519,243,471,3,39,51,219,267,303,327,423,435,27,63,231,291,411,447,519,243,471,3,39,51,303,27,63,219,231,291,411,423,447,519,243,471,3,27,39,51,255,267,279,291,303,483,63,219,231,423,411,447,519,243,471,3,39,51,303,27,63,99,219,231,243,267,411,423,255,279,291,315,327,339,351,435,447,459,471,483,495,519,3,39,51,303,27,63,219,231,243,291,351,411,423,447,519,471,3,39,51,303,435,27,63,99,219,231,243,255,411,423,447,459,483,495,519,291,351,471,3,39,51,303,423,447,27,63,219,231,243,267,279,291,351,411,519,471,3,39,51,267,303,327,423,435,27,63,99,219,231,243,291,411,447,459,471,483,519,495,351,3,39,51,303,27,63,99,219,231,243,279,411,423,435,447,459,471,519,483,495,291,351,3,27,39,51,63,99,219,231,243,255,267,279,291,303,315,327,339,351,375,399,411,423,435,447,459,471,483,495,507,519,3,27,39,51,255,267,279,291,303,483,63,99,219,231,243,327,375,411,423,447,471,315,339,351,435,459,495,519,3,27,39,51,255,267,279,291,303,483,63,219,231,243,351,411,423,447,519,471,3,27,39,51,255,267,279,291,303,435,483,63,99,219,231,243,315,411,423,447,459,471,519,495,351,3,27,39,51,255,267,279,291,303,423,447,483,63,219,231,243,327,339,351,411,519,471,3,27,39,51,255,267,279,291,303,327,423,435,483,63,99,219,231,243,351,411,447,459,471,495,519,3,27,39,51,255,267,279,291,303,483,63,99,219,231,243,339,411,423,435,447,459,471,519,495,351,3,39,51,303,27,63,75,87,219,231,243,255,267,279,291,315,327,339,351,435,459,471,483,363,375,399,411,423,447,495,507,519,3,39,51,303,435,459,27,63,219,231,243,255,267,279,291,315,327,339,351,363,375,399,471,507,411,423,447,483,495,519,3,39,51,303,399,423,435,447,459,27,63,219,231,243,255,267,279,291,315,327,339,351,363,375,471,507,411,483,495,519,3,39,51,219,303,327,423,435,27,63,231,243,291,351,483,495,519,471,3,39,51,303,459,27,63,219,231,243,291,351,483,495,519,471,3,39,51,219,231,255,267,303,327,339,411,423,435,447,459,471,483,495,507,519,27,63,243,291,351,3,39,51,219,231,255,267,279,303,327,339,411,423,435,447,459,471,483,495,507,519,27,63,243,291,351,4,40,52,304,28,256,268,280,316,328,76,88,340,364,376,400,412,424,436,448,460,484,496,508,520,16,64,100,220,232,244,292,352,472,4,40,52,304,28,64,220,232,412,424,448,520,244,472,4,40,52,304,16,100,268,412,424,256,280,316,328,340,436,448,460,484,496,520,28,64,220,232,244,292,352,472,4,28,40,52,256,268,280,292,304,484,16,100,244,328,412,424,448,316,340,436,460,496,520,64,220,232,352,472,4,40,52,304,16,28,64,100,220,232,244,256,268,280,292,316,328,76,88,340,352,364,376,400,412,424,436,448,460,472,484,496,508,520,4,40,52,220,232,304,436,460,16,28,64,100,244,256,268,280,316,328,340,412,424,448,484,496,520,292,352,472,4,40,52,220,304,436,16,28,64,256,268,280,292,316,328,340,376,400,412,424,448,484,364,460,496,508,520,100,232,244,352,472,4,40,52,220,232,268,280,304,328,340,400,424,436,448,460,16,28,64,100,244,256,316,412,484,496,520,292,352,472,4,40,52,220,268,304,328,424,436,16,28,64,256,280,292,316,340,352,376,400,412,448,484,496,364,460,508,520,100,232,244,472,4,40,52,304,16,28,64,256,268,280,292,316,328,340,352,376,400,412,424,448,484,496,364,436,460,508,520,100,220,232,244,472,4,40,52,304,28,64,220,232,244,256,268,292,352,436,460,412,424,448,472,520,4,40,52,220,304,436,28,64,232,412,424,448,520,244,472,4,40,52,220,268,304,328,424,436,28,64,232,292,412,448,520,244,472,4,40,52,304,28,64,220,232,292,412,424,448,520,244,472,4,28,40,52,256,268,280,292,304,484,64,220,232,424,412,448,520,244,472,4,40,52,304,28,64,100,220,232,244,268,412,424,256,280,292,316,328,340,352,436,448,460,472,484,496,520,4,40,52,304,28,64,220,232,244,292,352,412,424,448,520,472,4,40,52,304,436,28,64,100,220,232,244,256,412,424,448,460,484,496,520,292,352,472,4,40,52,304,424,448,28,64,220,232,244,268,280,292,352,412,520,472,4,40,52,268,304,328,424,436,28,64,100,220,232,244,292,412,448,460,472,484,520,496,352,4,40,52,304,28,64,100,220,232,244,280,412,424,436,448,460,472,520,484,496,292,352,4,28,40,52,64,100,220,232,244,256,268,280,292,304,316,328,340,352,376,400,412,424,436,448,460,472,484,496,508,520,4,28,40,52,256,268,280,292,304,484,64,100,220,232,244,328,376,412,424,448,472,316,340,352,436,460,496,520,4,28,40,52,256,268,280,292,304,484,64,220,232,244,352,412,424,448,520,472,4,28,40,52,256,268,280,292,304,436,484,64,100,220,232,244,316,412,424,448,460,472,520,496,352,4,28,40,52,256,268,280,292,304,424,448,484,64,220,232,244,328,340,352,412,520,472,4,28,40,52,256,268,280,292,304,328,424,436,484,64,100,220,232,244,352,412,448,460,472,496,520,4,28,40,52,256,268,280,292,304,484,64,100,220,232,244,340,412,424,436,448,460,472,520,496,352,4,40,52,304,28,64,76,88,220,232,244,256,268,280,292,316,328,340,352,436,460,472,484,364,376,400,412,424,448,496,508,520,4,40,52,304,436,460,28,64,220,232,244,256,268,280,292,316,328,340,352,364,376,400,472,508,412,424,448,484,496,520,4,40,52,304,400,424,436,448,460,28,64,220,232,244,256,268,280,292,316,328,340,352,364,376,472,508,412,484,496,520,4,40,52,220,304,328,424,436,28,64,232,244,292,352,484,496,520,472,4,40,52,304,460,28,64,220,232,244,292,352,484,496,520,472,4,40,52,220,232,256,268,304,328,340,412,424,436,448,460,472,484,496,508,520,28,64,244,292,352,4,40,52,220,232,256,268,280,304,328,340,412,424,436,448,460,472,484,496,508,520,28,64,244,292,352,5,41,53,305,29,257,269,281,317,329,77,89,341,365,377,401,413,425,437,449,461,485,497,509,521,17,65,101,221,233,245,293,353,473,5,41,53,305,29,65,221,233,413,425,449,521,245,473,5,41,53,305,17,101,269,413,425,257,281,317,329,341,437,449,461,485,497,521,29,65,221,233,245,293,353,473,5,29,41,53,257,269,281,293,305,485,17,101,245,329,413,425,449,317,341,437,461,497,521,65,221,233,353,473,5,41,53,305,17,29,65,101,221,233,245,257,269,281,293,317,329,77,89,341,353,365,377,401,413,425,437,449,461,473,485,497,509,521,5,41,53,221,233,305,437,461,17,29,65,101,245,257,269,281,317,329,341,413,425,449,485,497,521,293,353,473,5,41,53,221,305,437,17,29,65,257,269,281,293,317,329,341,377,401,413,425,449,485,365,461,497,509,521,101,233,245,353,473,5,41,53,221,233,269,281,305,329,341,401,425,437,449,461,17,29,65,101,245,257,317,413,485,497,521,293,353,473,5,41,53,221,269,305,329,425,437,17,29,65,257,281,293,317,341,353,377,401,413,449,485,497,365,461,509,521,101,233,245,473,5,41,53,305,17,29,65,257,269,281,293,317,329,341,353,377,401,413,425,449,485,497,365,437,461,509,521,101,221,233,245,473,5,41,53,305,29,65,221,233,245,257,269,293,353,437,461,413,425,449,473,521,5,41,53,221,305,437,29,65,233,413,425,449,521,245,473,5,41,53,221,269,305,329,425,437,29,65,233,293,413,449,521,245,473,5,41,53,305,29,65,221,233,293,413,425,449,521,245,473,5,29,41,53,257,269,281,293,305,485,65,221,233,425,413,449,521,245,473,5,41,53,305,29,65,221,233,245,293,353,413,425,449,521,473,5,41,53,305,437,29,65,101,221,233,245,257,413,425,449,461,485,497,521,293,353,473,5,41,53,305,425,449,29,65,221,233,245,269,281,293,353,413,521,473,5,41,53,269,305,329,425,437,29,65,101,221,233,245,293,413,449,461,473,485,521,497,353,5,41,53,305,29,65,101,221,233,245,281,413,425,437,449,461,473,521,485,497,293,353,5,29,41,53,65,101,221,233,245,257,269,281,293,305,317,329,341,353,377,401,413,425,437,449,461,473,485,497,509,521,5,29,41,53,257,269,281,293,305,485,65,101,221,233,245,329,377,413,425,449,473,317,341,353,437,461,497,521,5,29,41,53,257,269,281,293,305,485,65,221,233,245,353,413,425,449,521,473,5,29,41,53,257,269,281,293,305,437,485,65,101,221,233,245,317,413,425,449,461,473,521,497,353,5,29,41,53,257,269,281,293,305,425,449,485,65,221,233,245,329,341,353,413,521,473,5,29,41,53,257,269,281,293,305,329,425,437,485,65,101,221,233,245,353,413,449,461,473,497,521,5,29,41,53,257,269,281,293,305,485,65,101,221,233,245,341,413,425,437,449,461,473,521,497,353,5,41,53,305,29,65,77,89,221,233,245,257,269,281,293,317,329,341,353,437,461,473,485,365,377,401,413,425,449,497,509,521,5,41,53,305,437,461,29,65,221,233,245,257,269,281,293,317,329,341,353,365,377,401,473,509,413,425,449,485,497,521,5,41,53,305,401,425,437,449,461,29,65,221,233,245,257,269,281,293,317,329,341,353,365,377,473,509,413,485,497,521,5,41,53,221,305,329,425,437,29,65,233,245,293,353,485,497,521,473,5,41,53,305,461,29,65,221,233,245,293,353,485,497,521,473,5,41,53,221,233,257,269,305,329,341,413,425,437,449,461,473,485,497,509,521,29,65,245,293,353,5,41,53,221,233,257,269,281,305,329,341,413,425,437,449,461,473,485,497,509,521,29,65,245,293,353,6,42,54,306,30,258,270,282,318,330,78,90,342,366,378,402,414,426,438,450,462,486,498,510,522,18,66,102,222,234,246,294,354,474,6,42,54,306,30,66,222,234,414,426,450,522,246,474,6,42,54,306,18,102,270,414,426,258,282,318,330,342,438,450,462,486,498,522,30,66,222,234,246,294,354,474,6,30,42,54,258,270,282,294,306,486,18,102,246,330,414,426,450,318,342,438,462,498,522,66,222,234,354,474,6,42,54,306,18,30,66,102,222,234,246,258,270,282,294,318,330,78,90,342,354,366,378,402,414,426,438,450,462,474,486,498,510,522,6,42,54,222,234,306,438,462,18,30,66,102,246,258,270,282,318,330,342,414,426,450,486,498,522,294,354,474,6,42,54,222,306,438,18,30,66,258,270,282,294,318,330,342,378,402,414,426,450,486,366,462,498,510,522,102,234,246,354,474,6,42,54,222,234,270,282,306,330,342,402,426,438,450,462,18,30,66,102,246,258,318,414,486,498,522,294,354,474,6,42,54,222,270,306,330,426,438,18,30,66,258,282,294,318,342,354,378,402,414,450,486,498,366,462,510,522,102,234,246,474,6,42,54,306,18,30,66,258,270,282,294,318,330,342,354,378,402,414,426,450,486,498,366,438,462,510,522,102,222,234,246,474,6,42,54,306,30,66,222,234,246,258,270,294,354,438,462,414,426,450,474,522,6,42,54,222,306,438,30,66,234,414,426,450,522,246,474,6,42,54,222,270,306,330,426,438,30,66,234,294,414,450,522,246,474,6,42,54,306,30,66,222,234,294,414,426,450,522,246,474,6,30,42,54,258,270,282,294,306,486,66,222,234,426,414,450,522,246,474,6,42,54,306,30,66,222,234,246,294,354,414,426,450,522,474,6,42,54,306,438,30,66,102,222,234,246,258,414,426,450,462,486,498,522,294,354,474,6,42,54,306,426,450,30,66,222,234,246,270,282,294,354,414,522,474,6,42,54,270,306,330,426,438,30,66,102,222,234,246,294,414,450,462,474,486,522,498,354,6,42,54,306,30,66,102,222,234,246,282,414,426,438,450,462,474,522,486,498,294,354,6,30,42,54,66,102,222,234,246,258,270,282,294,306,318,330,342,354,378,402,414,426,438,450,462,474,486,498,510,522,6,30,42,54,258,270,282,294,306,486,66,222,234,246,354,414,426,450,522,474,6,30,42,54,258,270,282,294,306,438,486,66,102,222,234,246,318,414,426,450,462,474,522,498,354,6,30,42,54,258,270,282,294,306,426,450,486,66,222,234,246,330,342,354,414,522,474,6,30,42,54,258,270,282,294,306,330,426,438,486,66,102,222,234,246,354,414,450,462,474,498,522,6,30,42,54,258,270,282,294,306,486,66,102,222,234,246,342,414,426,438,450,462,474,522,498,354,6,42,54,306,30,66,78,90,222,234,246,258,270,282,294,318,330,342,354,438,462,474,486,366,378,402,414,426,450,498,510,522,6,42,54,306,402,426,438,450,462,30,66,222,234,246,258,270,282,294,318,330,342,354,366,378,474,510,414,486,498,522,6,42,54,222,306,330,426,438,30,66,234,246,294,354,486,498,522,474,6,42,54,306,462,30,66,222,234,246,294,354,486,498,522,474,6,42,54,222,234,258,270,306,330,342,414,426,438,450,462,474,486,498,510,522,30,66,246,294,354,6,42,54,222,234,258,270,282,306,330,342,414,426,438,450,462,474,486,498,510,522,30,66,246,294,354]),171,388);

    M0 = sparse([1,2,3,4,5,6,7,8,8,9,9,10,11,11,12,13,13,14,14,14,15,15,16,16,17,18,18,19,20,20,21,22,23,24,25,34,34,35,35,36,36,37,37,38,38,38,39,39,39,40,40,40,41,41,41,42,42,42,43,43,43,44,45,46,47,48,49,50,51,52,53,53,54,55,55,55,56,56,56,57,57,57,58,59,60,61,62,63,64,65,66,67,68,69,69,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,90,90,91,91,92,92,93,94,95,95,96,96,97,98,98,99,100,101,102,102,102,103,103,103,104,104,104,105,105,105,106,106,106,107,107,107,108,109,110,111,112,113,114,114,114,121,122,123,124,125,126,127,128,130,131,133,134,135,136,143,146,148,149,150,151,152,153,154,155,156,157,157,157,158,158,158,159,160,160,160,161,162,162,162,163,164,165,166,167,168,171,172,173,174,175,176,177,178,178,178],[40,42,43,44,47,48,49,29,59,30,60,61,31,62,63,32,64,178,200,206,33,74,34,75,76,35,77,78,36,79,174,179,180,181,94,88,182,90,184,89,183,91,185,21,179,186,22,180,187,23,92,99,24,181,188,25,93,100,26,94,101,102,103,104,105,106,109,107,108,110,95,111,113,27,97,114,146,160,163,148,162,166,115,116,117,118,119,122,120,121,123,124,192,28,98,194,144,145,127,128,129,130,131,197,199,200,37,38,38,39,127,134,128,135,129,136,149,150,129,136,130,137,151,131,138,150,151,152,175,197,201,176,198,202,86,132,203,177,199,204,87,133,205,178,200,206,139,140,153,141,154,207,159,170,171,81,142,143,155,156,157,208,158,89,90,160,161,162,209,129,129,129,183,197,184,198,199,105,108,109,146,160,163,147,161,164,165,148,162,166,167,196,209,210,168,118,121,122,169,129,170,136,150,160,151,161,162,159,170,171],[-L1,-L1,-L1,-L1,-L1,-L1,-L1,1,-L1,1,-L1,-L1,1,-L1,-L1,1,-L1,L1,2*L1,-L1^2,1,-L1,1,-L1,-L1,1,-L1,-L1,1,-L1,-L1,-L1,-L1,-L1,-L1,1,-L1,1,-L1,1,-L1,1,-L1,1,1,-L1,1,1,-L1,1,1,-L1,1,1,-L1,1,1,-L1,1,1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,1,-L1,-L1,1,1,-L1,L1,2*L1,-L1^2,L1,2*L1,-L1^2,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,1,1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-1,-1,-1,-1,1,-L1,1,-L1,1,-L1,-L1,-L1,1,-L1,1,-L1,-L1,1,-L1,-L1,-L1,-L1,1,1,-L1,1,1,-L1,1,1,-L1,1,1,-L1,1,1,-L1,1,1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,L1,2*L1,-L1^2,-1,-L1,-L1,-L1,-L1,-L1,-L1,-L1,-1,-1,-L1,-L1,-L1,-L1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-L1,1,1,-L1,-L1,1,1,-L1,-L1,1,1,-L1,-L1,-1,-1,-1,-L1,-1,-L1,-1,-1,-1,-1,-1,-1,1,1,-L1],178,210);
    M = M(:,179:end)-M(:,1:178)*M0; % Schur complement reduction

    [L,~,p] = lu(M(:,1:143),'vector');
    M = M(p(end-27:end),144:end)-L(end-27:end,:)*(L(1:143,:)\M(p(1:143),144:end));
    %[M,~] = qr(M(:,1:143),M(:,144:end));
    %M = M(end-27:end,:);

    T0 = zeros(39);
    T0([1,2,4,5,6,11,12,13,14,18,19,20,21,22,24,25,26,27,28,30,31,32,33,34,36,37,38,39],:) = -M(:,29:end);
    T0([900,943,983,1023,1063,1146,1186,1265,1427,1472,1517]) = 1;
    T1 = zeros(39);
    T1([1,2,4,5,6,11,12,13,14,18,19,20,21,22,24,25,26,27,28,30,31,32,33,34,36,37,38,39],[1,2,4,5,6,11,12,13,14,18,19,20,21,22,24,25,26,27,28,30,31,32,33,34,36,37,38,39]) = M(:,1:28);
    T1([81,241,281,321,361,561,601,641,881,1121,1361]) = 1;

    [V,~] = eig(T0,T1);
    S = V(30:38,:)./V(39,:);
    S = S(:,all(isfinite(S)));

end



function [Rt,err] = S2Rt6p6p(S,C,U,RR,realOnly)

    k = 20; % number of true roots
    z = nan(size(C,2),size(S,2));
    for i = 1:size(S,2); z(:,i) = U(S(:,i)); end
    z = z./vecnorm(z);
    e = vecnorm(C*z);
    [e,I] = sort(e);
    S = S(:,I(1:k)); % filter out false roots
    err = repmat(e(1:k),1,2);

    if realOnly; c = ~any(imag(S),1) & S(1,:)>0; S = S(:,c); err = err(repmat(c,1,2)); end

    k = size(S,2);
    Rt = cell([1,2*k]);
    for i = 1:k
        a = sqrt(S(1,i));
        Rt{i} = [RR{1}*cayley([a; S(2,i)/a; S(6,i)])*RR{2}', RR{1}*[S(7,i); S(8,i); S(3,i)/a]];
        Rt{k+i} = [RR{1}*cayley([-a; -S(2,i)/a; S(6,i)])*RR{2}', RR{1}*[S(7,i); S(8,i); -S(3,i)/a]];
    end

end